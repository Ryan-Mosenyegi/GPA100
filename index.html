<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Semester GPA Planner & Archive</title>
  <style>
    :root {
      --bg-color: #f8fafc;
      --text-color: #1e293b;
      --container-bg: white;
      --module-bg: #f1f5f9;
      --task-bg: #e2e8f0;
      --done-bg: #bbf7d0;
      --border-color: #cbd5e1;
      --notes-bg: #fff7ed;
      --notes-border: #f97316;
      --semester1-bg: #dbeafe;
      --semester2-bg: #fee2e2;
      --daily-log-bg: #ecfdf5;
      --daily-log-border: #10b981;
    }
    .dark-mode {
      --bg-color: #0f172a;
      --text-color: #e2e8f0;
      --container-bg: #1e293b;
      --module-bg: #334155;
      --task-bg: #475569;
      --done-bg: #166534;
      --border-color: #475569;
      --notes-bg: #431407;
      --notes-border: #9a3412;
      --semester1-bg: #1e3a8a;
      --semester2-bg: #7f1d1d;
      --daily-log-bg: #064e3b;
      --daily-log-border: #047857;
    }
    body {
      font-family: Arial, sans-serif;
      background: var(--bg-color);
      color: var(--text-color);
      margin: 0;
      padding: 0;
      line-height: 1.6;
    }
    .container {
      max-width: 1000px;
      margin: 1rem auto;
      padding: 1rem;
      background: var(--container-bg);
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    h1, h2, h3, h4 {
      text-align: center;
      color: var(--text-color);
    }
    .module, .custom-module, .gpa-form, .exam-records, .module-adder, .daily-log {
      background: var(--module-bg);
      padding: 1rem;
      margin-bottom: 1rem;
      border-radius: 8px;
      overflow-x: auto;
    }
    .week {
      margin-bottom: 1.5rem;
    }
    ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    li {
      padding: 0.75rem;
      margin: 0.5rem 0;
      background: var(--task-bg);
      border-radius: 8px;
      display: flex;
      align-items: center;
      cursor: pointer;
      word-break: break-word;
    }
    li.done {
      text-decoration: line-through;
      background: var(--done-bg);
    }
    input[type="checkbox"] {
      min-width: 20px;
      min-height: 20px;
      margin-right: 1rem;
      cursor: pointer;
    }
    textarea, input[type="text"], input[type="number"], input[type="date"], input[type="time"] {
      width: 100%;
      margin-top: 0.5rem;
      padding: 0.75rem;
      border-radius: 6px;
      border: 1px solid var(--border-color);
      font-family: inherit;
      font-size: 1rem;
      box-sizing: border-box;
      background: var(--container-bg);
      color: var(--text-color);
    }
    .dark-toggle {
      display: block;
      margin: 1rem auto;
      padding: 0.75rem 1.5rem;
      background: var(--module-bg);
      color: var(--text-color);
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: bold;
    }
    button {
      padding: 0.75rem 1.5rem;
      background: #3b82f6;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 1rem;
      margin-top: 0.5rem;
      width: 100%;
      transition: background 0.3s;
    }
    button:hover {
      background: #2563eb;
    }
    button.secondary {
      background: var(--task-bg);
      color: var(--text-color);
    }
    button.secondary:hover {
      background: var(--border-color);
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
      font-size: 0.9rem;
    }
    th, td {
      padding: 0.75rem;
      border: 1px solid var(--border-color);
      text-align: left;
    }
    th {
      background: var(--task-bg);
      font-weight: bold;
    }
    .module-notes, .daily-entry {
      background: var(--notes-bg);
      padding: 0.75rem;
      border-left: 4px solid var(--notes-border);
      margin: 0.5rem 0;
      border-radius: 4px;
    }
    .daily-entry {
      background: var(--daily-log-bg);
      border-left-color: var(--daily-log-border);
    }
    .module-notes textarea, .daily-entry textarea {
      min-height: 80px;
      resize: vertical;
    }
    #gpa-result {
      font-weight: bold;
      margin-top: 1rem;
      text-align: center;
      font-size: 1.1rem;
    }
    .mark-inputs {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 0.5rem;
      margin-bottom: 0.5rem;
    }
    .mark-inputs input {
      margin: 0;
    }
    .semester-gpa {
      font-weight: bold;
      margin: 0.5rem 0;
      padding: 0.5rem;
      border-radius: 4px;
    }
    .semester1 {
      background: var(--semester1-bg);
    }
    .semester2 {
      background: var(--semester2-bg);
    }
    .year-gpa {
      font-weight: bold;
      margin: 1rem 0;
      padding: 0.75rem;
      background: var(--module-bg);
      border-radius: 6px;
      text-align: center;
    }
    .datetime-inputs {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0.5rem;
      margin-bottom: 0.5rem;
    }
    .log-entries {
      margin-top: 1rem;
    }
    .log-entry {
      background: var(--daily-log-bg);
      padding: 0.75rem;
      margin: 0.5rem 0;
      border-radius: 6px;
      border-left: 4px solid var(--daily-log-border);
    }
    .log-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.5rem;
      font-weight: bold;
    }
    .log-content {
      white-space: pre-wrap;
    }
    .tabs {
      display: flex;
      margin-bottom: 1rem;
      border-bottom: 1px solid var(--border-color);
    }
    .tab {
      padding: 0.75rem 1.5rem;
      cursor: pointer;
      border-bottom: 3px solid transparent;
    }
    .tab.active {
      border-bottom-color: #3b82f6;
      font-weight: bold;
    }

    @media (max-width: 768px) {
      .container {
        margin: 0;
        border-radius: 0;
        padding: 0.75rem;
      }
      h1 {
        font-size: 1.5rem;
      }
      h2 {
        font-size: 1.3rem;
      }
      h3 {
        font-size: 1.1rem;
      }
      table {
        font-size: 0.8rem;
      }
      th, td {
        padding: 0.5rem;
      }
      .mark-inputs, .datetime-inputs {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 480px) {
      table {
        display: block;
        overflow-x: auto;
        white-space: nowrap;
      }
      .module, .custom-module, .gpa-form, .exam-records, .module-adder, .daily-log {
        padding: 0.75rem;
      }
      li {
        padding: 0.5rem;
      }
      .tab {
        padding: 0.5rem 1rem;
        font-size: 0.9rem;
      }
    }
  </style>
</head>
<body>
  <button class="dark-toggle" onclick="document.body.classList.toggle('dark-mode')">üåô Toggle Dark Mode</button>
  <div class="container">
    <h1>üìö Semester GPA Planner & Archive</h1>

    <div class="tabs">
      <div class="tab active" onclick="showTab('planner-tab')">Planner</div>
      <div class="tab" onclick="showTab('gpa-tab')">GPA Calculator</div>
      <div class="tab" onclick="showTab('history-tab')">Academic History</div>
      <div class="tab" onclick="showTab('daily-tab')">Daily Log</div>
    </div>

    <div id="planner-tab" class="tab-content">
      <h2>üóìÔ∏è Weekly Planner</h2>
      <div id="planner"></div>

      <div class="module-adder">
        <h2>‚ûï Add Your Own Module</h2>
        <input type="text" id="modTitle" placeholder="Module Title">
        <textarea id="modTasks" placeholder="Write tasks separated by new lines"></textarea>
        <button onclick="addModule()">Add Module</button>
        <div id="custom-modules"></div>
      </div>
    </div>

    <div id="gpa-tab" class="tab-content" style="display:none;">
      <div class="gpa-form">
        <h2>üéØ GPA Calculator</h2>
        <p>Enter your module marks (out of 100):</p>
        <div class="mark-inputs">
          <input type="number" id="mark1" placeholder="Module 1 Mark" min="0" max="100">
          <input type="number" id="mark2" placeholder="Module 2 Mark" min="0" max="100">
          <input type="number" id="mark3" placeholder="Module 3 Mark" min="0" max="100">
        </div>
        <button onclick="calculateGPA()">Calculate GPA</button>
        <p id="gpa-result"></p>
      </div>
    </div>

    <div id="history-tab" class="tab-content" style="display:none;">
      <div class="exam-records">
        <h2>üìú Academic History (Year 1)</h2>
        
        <div class="semester-gpa semester1" id="semester1-gpa">Semester 1 GPA: Calculating...</div>
        <table id="semester1-table">
          <thead>
            <tr>
              <th>Semester</th>
              <th>Module Code</th>
              <th>Module Name</th>
              <th>Mark (%)</th>
              <th>Grade</th>
              <th>GPA</th>
            </tr>
          </thead>
          <tbody>
            <tr><td>Semester 1</td><td>DTA101</td><td>Introduction to Data Analytics</td><td>73</td><td></td><td></td></tr>
            <tr><td>Semester 1</td><td>DTA103</td><td>Data Visualization</td><td>66</td><td></td><td></td></tr>
            <tr><td>Semester 1</td><td>DTA104</td><td>Statistics for Analytics</td><td>65</td><td></td><td></td></tr>
          </tbody>
        </table>
        
        <div class="semester-gpa semester2" id="semester2-gpa">Semester 2 GPA: Calculating...</div>
        <table id="semester2-table">
          <thead>
            <tr>
              <th>Semester</th>
              <th>Module Code</th>
              <th>Module Name</th>
              <th>Mark (%)</th>
              <th>Grade</th>
              <th>GPA</th>
            </tr>
          </thead>
          <tbody>
            <tr><td>Semester 2</td><td>DTA105</td><td>Python for Data Analysis</td><td>59</td><td></td><td></td></tr>
            <tr><td>Semester 2</td><td>DTA102</td><td>SQL and Databases</td><td>53</td><td></td><td></td></tr>
            <tr><td>Semester 2</td><td>DTA106</td><td>Machine Learning Fundamentals</td><td>85</td><td></td><td></td></tr>
          </tbody>
        </table>
        
        <div class="year-gpa" id="year-gpa">Year 1 GPA: Calculating...</div>
      </div>
    </div>

    <div id="daily-tab" class="tab-content" style="display:none;">
      <div class="daily-log">
        <h2>üìÖ Daily Activity Log</h2>
        
        <div class="datetime-inputs">
          <input type="date" id="log-date" value="">
          <input type="time" id="log-time" value="">
        </div>
        
        <textarea id="log-entry" placeholder="What did you work on today? Include details about your study session, projects, or research..."></textarea>
        
        <div class="button-group">
          <button onclick="addDailyLog()">Add Log Entry</button>
          <button class="secondary" onclick="clearLogForm()">Clear Form</button>
        </div>
        
        <div class="log-entries" id="log-entries">
          <h3>Your Log History</h3>
          <!-- Log entries will appear here -->
        </div>
      </div>
    </div>
  </div>

  <script>
    const tasks = [
      { week: 1, text: "Organize course files and syllabus" },
      { week: 1, text: "Install Python and Jupyter Notebook" },
      { week: 2, text: "Review basic statistics concepts" },
      { week: 3, text: "Practice data cleaning with Pandas" },
      { week: 4, text: "Create first data visualization" },
      { week: 5, text: "Learn SQL basics and practice queries" },
      { week: 6, text: "Work on data analysis project" },
      { week: 7, text: "Start revision and make flashcards" },
      { week: 8, text: "Practice machine learning concepts" },
      { week: 9, text: "Complete data analysis case study" },
      { week: 10, text: "Revise key concepts and formulas" },
      { week: 11, text: "Practice with past exam questions" },
      { week: 12, text: "Final review and preparation" },
    ];

    const planner = document.getElementById("planner");
    const weeks = Array.from(new Set(tasks.map(t => t.week)));

    // Set default date to today
    document.getElementById('log-date').valueAsDate = new Date();

    // Tab functionality
    function showTab(tabId) {
      document.querySelectorAll('.tab-content').forEach(tab => {
        tab.style.display = 'none';
      });
      document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.remove('active');
      });
      document.getElementById(tabId).style.display = 'block';
      event.currentTarget.classList.add('active');
    }

    // Daily log functions
    function addDailyLog() {
      const date = document.getElementById('log-date').value;
      const time = document.getElementById('log-time').value;
      const entry = document.getElementById('log-entry').value.trim();
      
      if (!date || !entry) {
        alert("Please enter both date and log entry");
        return;
      }
      
      const timestamp = `${date} ${time || '00:00'}`;
      const logEntry = {
        id: Date.now(),
        date: date,
        time: time || '00:00',
        timestamp: timestamp,
        entry: entry
      };
      
      // Save to localStorage
      const logs = JSON.parse(localStorage.getItem('dailyLogs') || []);
      logs.push(logEntry);
      localStorage.setItem('dailyLogs', JSON.stringify(logs));
      
      // Add to display
      addLogToDisplay(logEntry);
      
      // Clear the entry field (but keep date/time)
      document.getElementById('log-entry').value = '';
    }
    
    function addLogToDisplay(logEntry) {
      const logEntries = document.getElementById('log-entries');
      const logDiv = document.createElement('div');
      logDiv.className = 'log-entry';
      logDiv.innerHTML = `
        <div class="log-header">
          <span>${formatDateTime(logEntry.timestamp)}</span>
          <button onclick="deleteLogEntry(${logEntry.id})" class="secondary" style="padding: 0.25rem 0.5rem; width: auto;">Delete</button>
        </div>
        <div class="log-content">${logEntry.entry.replace(/\n/g, '<br>')}</div>
      `;
      
      // Insert at the top
      if (logEntries.children.length > 1) { // Skip the "Your Log History" h3
        logEntries.insertBefore(logDiv, logEntries.children[1]);
      } else {
        logEntries.appendChild(logDiv);
      }
    }
    
    function formatDateTime(timestamp) {
      const options = { 
        year: 'numeric', 
        month: 'short', 
        day: 'numeric',
        hour: '2-digit', 
        minute: '2-digit',
        hour12: true
      };
      return new Date(timestamp).toLocaleString(undefined, options);
    }
    
    function deleteLogEntry(id) {
      let logs = JSON.parse(localStorage.getItem('dailyLogs') || []);
      logs = logs.filter(log => log.id !== id);
      localStorage.setItem('dailyLogs', JSON.stringify(logs));
      
      // Refresh display
      loadDailyLogs();
    }
    
    function loadDailyLogs() {
      const logEntries = document.getElementById('log-entries');
      // Clear existing entries (but keep the header)
      while (logEntries.children.length > 1) {
        logEntries.removeChild(logEntries.lastChild);
      }
      
      const logs = JSON.parse(localStorage.getItem('dailyLogs') || []);
      // Sort by timestamp (newest first)
      logs.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
      
      logs.forEach(log => addLogToDisplay(log));
    }
    
    function clearLogForm() {
      document.getElementById('log-entry').value = '';
      document.getElementById('log-date').valueAsDate = new Date();
      document.getElementById('log-time').value = '';
    }

    // GPA calculation functions
    function markToGrade(mark) {
      if (mark >= 80) return 'A';
      if (mark >= 70) return 'B';
      if (mark >= 60) return 'C';
      if (mark >= 50) return 'D';
      if (mark >= 40) return 'E';
      return 'F';
    }
    
    function markToGPA(mark) {
      if (mark >= 80) return 4.0;
      if (mark >= 70) return 3.5;
      if (mark >= 60) return 3.0;
      if (mark >= 50) return 2.5;
      if (mark >= 40) return 2.0;
      if (mark >= 30) return 1.0;
      return 0.0;
    }
    
    function calculateSemesterGPA(tableId, resultElementId) {
      const table = document.getElementById(tableId);
      const rows = table.querySelectorAll('tbody tr');
      let totalGPA = 0;
      let count = 0;
      
      rows.forEach(row => {
        const mark = parseFloat(row.cells[3].textContent);
        if (!isNaN(mark)) {
          const grade = markToGrade(mark);
          const gpa = markToGPA(mark);
          row.cells[4].textContent = grade;
          row.cells[5].textContent = gpa.toFixed(1);
          totalGPA += gpa;
          count++;
        }
      });
      
      const semesterGPA = (count > 0) ? (totalGPA / count).toFixed(2) : 0;
      document.getElementById(resultElementId).textContent = 
        resultElementId.includes('semester1') ? 
        `Semester 1 GPA: ${semesterGPA}` : 
        `Semester 2 GPA: ${semesterGPA}`;
      
      return parseFloat(semesterGPA);
    }
    
    function calculateYearGPA() {
      const semester1GPA = calculateSemesterGPA('semester1-table', 'semester1-gpa');
      const semester2GPA = calculateSemesterGPA('semester2-table', 'semester2-gpa');
      
      const yearGPA = ((semester1GPA + semester2GPA) / 2).toFixed(2);
      document.getElementById('year-gpa').textContent = `Year 1 GPA: ${yearGPA}`;
    }

    function renderPlanner() {
      planner.innerHTML = '';
      weeks.forEach(week => {
        const weekSection = document.createElement("div");
        weekSection.classList.add("week");

        const header = document.createElement("h3");
        header.textContent = `Week ${week}`;
        weekSection.appendChild(header);

        const ul = document.createElement("ul");
        tasks.filter(t => t.week === week).forEach(task => {
          const li = document.createElement("li");
          const checkbox = document.createElement("input");
          checkbox.type = "checkbox";
          checkbox.checked = localStorage.getItem(task.text) === 'true';
          if (checkbox.checked) li.classList.add("done");
          checkbox.addEventListener("change", () => {
            li.classList.toggle("done", checkbox.checked);
            localStorage.setItem(task.text, checkbox.checked);
          });

          li.appendChild(checkbox);
          li.appendChild(document.createTextNode(task.text));

          const note = document.createElement("div");
          note.className = "module-notes";
          const noteField = document.createElement("textarea");
          noteField.placeholder = "Notes or reflections...";
          const noteKey = `note-${task.text}`;
          noteField.value = localStorage.getItem(noteKey) || "";
          noteField.addEventListener("input", () => {
            localStorage.setItem(noteKey, noteField.value);
          });

          note.appendChild(noteField);
          ul.appendChild(li);
          ul.appendChild(note);
        });

        weekSection.appendChild(ul);
        planner.appendChild(weekSection);
      });
    }

    function calculateGPA() {
      const marks = [
        parseFloat(document.getElementById('mark1').value),
        parseFloat(document.getElementById('mark2').value),
        parseFloat(document.getElementById('mark3').value)
      ];
      
      if (marks.some(isNaN)) {
        document.getElementById('gpa-result').innerText = "Please enter all marks.";
        return;
      }
      
      if (marks.some(mark => mark < 0 || mark > 100)) {
        document.getElementById('gpa-result').innerText = "Marks must be between 0-100.";
        return;
      }
      
      const gpa = marks.map(markToGPA);
      const finalGPA = (gpa.reduce((a, b) => a + b, 0) / gpa.length).toFixed(2);
      document.getElementById('gpa-result').innerText = `Your GPA is ${finalGPA}`;
    }

    function addModule() {
      const title = document.getElementById('modTitle').value.trim();
      const tasksText = document.getElementById('modTasks').value.trim();
      if (!title || !tasksText) {
        alert("Please enter both module title and tasks");
        return;
      }
      
      const tasks = tasksText.split('\n').filter(t => t.trim());
      if (tasks.length === 0) {
        alert("Please enter at least one task");
        return;
      }
      
      const div = document.createElement('div');
      div.className = 'custom-module';
      div.innerHTML = `<h3>${title}</h3><ul>`;
      
      tasks.forEach(task => {
        const taskKey = `custom-${title}-${task}`;
        const noteKey = `custom-note-${title}-${task}`;
        
        const isDone = localStorage.getItem(taskKey) === 'true';
        const savedNote = localStorage.getItem(noteKey) || '';
        
        div.innerHTML += `
          <li class="${isDone ? 'done' : ''}">
            <input type='checkbox' ${isDone ? 'checked' : ''}>
            ${task}
            <div class='module-notes'>
              <textarea placeholder='Notes or reflections...'>${savedNote}</textarea>
            </div>
          </li>
        `;
      });
      
      div.innerHTML += `</ul>`;
      document.getElementById('custom-modules').appendChild(div);
      
      // Add event listeners to the new checkboxes and textareas
      div.querySelectorAll('input[type="checkbox"]').forEach((checkbox, index) => {
        checkbox.addEventListener('change', function() {
          const li = this.parentElement;
          li.classList.toggle('done', this.checked);
          const taskKey = `custom-${title}-${tasks[index]}`;
          localStorage.setItem(taskKey, this.checked);
        });
      });
      
      div.querySelectorAll('textarea').forEach((textarea, index) => {
        textarea.addEventListener('input', function() {
          const noteKey = `custom-note-${title}-${tasks[index]}`;
          localStorage.setItem(noteKey, this.value);
        });
      });
      
      document.getElementById('modTitle').value = '';
      document.getElementById('modTasks').value = '';
    }

    // Initialize the page
    document.addEventListener('DOMContentLoaded', function() {
      renderPlanner();
      calculateYearGPA();
      loadDailyLogs();
      
      // Set default time to current time
      const now = new Date();
      document.getElementById('log-time').value = 
        `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
    });
  </script>
</body>
</html>
